= Author your first agentic service
:page-aliases: java:build-your-first-application.adoc, java:author-your-first-service.adoc

include::ROOT:partial$include.adoc[]

== Introduction 

include::ROOT:partial$concepts-intro.adoc[]

In this guide, you will:

* Set up your development environment.
* Generate a simple project from a template that follows the recommended xref:concepts:architecture-model.adoc#_architecture[onion architecture].
* Explore a basic AI Agent that acts as a creative greeter.
* Explore a basic HTTP Endpoint to interact with the agent.
* Add a request body to the Endpoint.
* Run your service locally.
* Play a multilingual game with the agent.
* Explore the local console to observe your running service.

== Prerequisites

include::ROOT:partial$local-dev-prerequisites.adoc[]
* https://platform.openai.com/api-keys[OpenAI API key, window="new"]

Akka has support for many AI providers, and this sample is using OpenAI.

You can run this sample without an OpenAI API key, but it will be more fun if you have one. Sign up for free at https://platform.openai.com/api-keys[platform.openai.com/api-keys, window="new"]. If you don't provide an API key, it will use a predefined response instead of using AI.

== Generate and build the project

The Maven archetype template prompts you to specify the project's group ID, name and version interactively. Run it using the commands shown for your operating system.

****
If you are using IntelliJ, you can skip the command line entirely. Simply open the IDE and follow these steps:

. Go to *File > New > Project*.
. Select *Maven Archetype* from the list of Generators.
. Fill out the project details:
  * *Name*: Enter the desired project name, such as `helloworld`.
  * *Location*: Specify the directory where you want the project to be created.
  * *JDK*: Select Java {java-version} or a later version.
. Under *Catalog*, ensure "Maven Central" is selected.
. In the *Archetype* section, click the dropdown and select `io.akka:akka-javasdk-archetype`.
. Set the *Version* to `{akka-javasdk-version}`.
. Click *Create*.

IntelliJ will handle the project generation and setup for you, allowing you to begin development immediately.
****

Follow these steps to generate and build your project:

. From a command line, create a new Maven project from the Akka archetype in a convenient location:
+
[.tabset]
Linux or macOS::
+
--
[source,command window, subs="attributes"]
----
mvn archetype:generate \
  -DarchetypeGroupId=io.akka \
  -DarchetypeArtifactId=akka-javasdk-archetype \
  -DarchetypeVersion={akka-javasdk-version}
----
--
Windows 10+::
+
--
[source,command window, subs="attributes"]
----
mvn archetype:generate ^
  -DarchetypeGroupId=io.akka ^
  -DarchetypeArtifactId=akka-javasdk-archetype ^
  -DarchetypeVersion={akka-javasdk-version}
----
--

+
.Fill in:
* groupId: `com.example`
* artifactId: `helloworld`
* version: `1.0-SNAPSHOT`
* package: `helloworld`

. Navigate to the new project directory.

. Open it in your preferred IDE / Editor.

== Explore the Agent

An _Agent_ interacts with an AI model and maintains contextual history in a session memory.

. Open the `src/main/java/com/example/application/HelloWorldAgent.java` file.

The _Agent_ is implemented with:

[source,java]
.HelloWorldAgent.java
----
include::java:example$doc-snippets/src/main/java/com/example/application/HelloWorldAgent.java[tag=class]
----

The system message provides system-level instructions to the AI model that defines its behavior and context. The system message acts as a foundational prompt that establishes the AI's role, constraints, and operational parameters. It is processed before user messages and helps maintain consistent behavior throughout the interactions.

The user message represents the specific query, instruction, or input that will be processed by the model to generate a response.

== Explore the HTTP Endpoint

An _Endpoint_ is a component that creates an externally accessible API. Endpoints are how you expose your services to the outside world. Endpoints can have different protocols, such as HTTP and gRPC.

HTTP Endpoint components make it possible to conveniently define such APIs accepting and responding in JSON, or dropping down to lower level APIs for ultimate flexibility in what types of data is accepted and returned.

. Open the `src/main/java/com/example/api/HelloWorldEndpoint.java` file.

The _Endpoint_ is implemented with:

[source,java]
.HelloWorldEndpoint.java
----
include::java:example$doc-snippets/src/main/java/com/example/api/HelloWorldEndpoint.java[tag=helloWorld]
----

The `ComponentClient` is the way to call the agent or other components. The agent may participate in a session, which is used for the agent's memory and can also be shared between multiple agents that are collaborating on the same goal.

This Endpoint is on the path `/hello` and exposes an HTTP GET operation on `/`.

You can also see that there is an _Access Control List_ (ACL) on this Endpoint that allows all traffic from the Internet. Without this ACL the service would be unreachable, but you can be very expressive with these ACLs.

== Run locally

Set your https://platform.openai.com/api-keys[OpenAI API key, window="new"] as an environment variable:

include::ROOT:partial$openai-api-key-env-vars.adoc[]

Start your service locally:

[source,command line]
----
mvn compile exec:java
----

Once successfully started, any defined Endpoints become available at `localhost:9000` and you will see an INFO message that the Akka Runtime has started.

In another shell, you can now use `curl` to send requests to this Endpoint.

[source, command line]
----
curl localhost:9000/hello
----

== Add your own greeting

In this section, you will modify the HTTP Endpoint to accept a request body using the code shown below:

[source,java]
.HelloWorldEndpoint.java
----
include::java:example$doc-snippets/src/main/java/com/example/api/HelloWorldEndpoint.java[tag=helloRequest]
----

Restart the service and curl this command:

[source, command line]
----
curl -i -XPOST -H "Content-Type: application/json" localhost:9000/hello -d '
{"greeting":"Ahoy there, matey!", "sessionId":"12345"}'
----

Does it recognize the pirate greeting?

== Play a language game

In this section, you'll play a simple language game with the agent using `curl`.

Each player must reply in a new language. The agent remembers previous languages and will end the game if a language is repeated.

To keep the game predictable, the agent is instructed to always begin in English. This prevents accidental repetition and allows you to observe memory in action.

[NOTE]
====
Be sure to include the language you're using in parentheses at the end of your message. This helps the agent track the game state correctly.
====

. Start the game:

[source, command line]
----
curl -i -XPOST -H "Content-Type: application/json" localhost:9000/hello -d \
'{"greeting":"Let'\''s play a language game. Each of us must reply in a new language every time. The first to repeat a language loses. Try to not lose the game. Always name the language you'\''re using in parentheses. You start. Use English first. If I repeat a language, announce that the game is over and that you won.","sessionId":"12345"}'
----

.Expected response:
[source,text]
----
Great! Let's begin. Hello there! Ready to put your languages to the test? (English)
----

. Reply in Portuguese:

[source, command line]
----
curl -i -XPOST -H "Content-Type: application/json" localhost:9000/hello -d \
'{"greeting":"Acho que vou ganhar este jogo! (Portuguese)", "sessionId":"12345"}'
----

.Expected response:
[source,text]
----
Well played! Here's my reply in a different language. (This response is in another language)
----

. Repeat a language to simulate a loss (Portuguese again):

[source, command line]
----
curl -i -XPOST -H "Content-Type: application/json" localhost:9000/hello -d \
'{"greeting":"Vamos ver se consigo ganhar de novo! (Portuguese)", "sessionId":"12345"}'
----

.Expected response:
[source,text]
----
Oops! Portuguese has already been used. That means I win this round. Thanks for playing! (English)
----

[IMPORTANT]
====
What just happened?

Akka Agents track context using *session memory*. In this case, the Agent remembered that Portuguese had already been used earlier in the same `sessionId`.

Session memory provides a history mechanism that enables agents to maintain context across multiple interactions. This feature is essential for building agents that can remember previous exchanges with users, understand context, and provide coherent responses over time.

====

== Explore the local console

The Akka local console is a web-based tool that provides a convenient way to view and interact with your running service.

=== Install the Akka CLI

Starting the local console requires using the Akka CLI and Docker.

include::ROOT:partial$cli-install-short.adoc[]

=== Start the local console

. Start the local console. It will launch a Docker container:
+
[source,bash]
----
akka local console

Pulling local console image, please wait...
----

. Once the console is running, you will see a message like this:
+
[source,bash]
----
- helloworld is running at: localhost:9000
-----------------------------------------------------
(use Ctrl+C to quit)
----

. You can then access the local console in your browser at:
+
http://localhost:3000[window="new"]

. Navigate to your service's Endpoint, which will be available http://localhost:3000/services/akka-javasdk-archetype/components/io.akka.api.HelloWorldEndpoint[here, window="new"].

image:hello-world-local-console.png[]

This is a simple Hello World service, so there isn't much to see here yet. However, as you build more complex services, the console will become a more valuable tool for monitoring and debugging.

== Next steps

Now that you have a basic service running, it's time to learn more about building real services in Akka. See xref:getting-started:build-and-deploy-shopping-cart.adoc[] to build a more realistic application and learn how to deploy it to https://console.akka.io[akka.io].